{% comment %}
  Featured Specs - Premium Edition
  Best Buy inspired: feature badges with icons, gradients, bold values
  Displays key specs from product_bridge.featured metafield
  Schema: [{title: string, value: string, icon?: string}]
  
  Icon options: camera, video, sensor, resolution, battery, memory, 
                processor, display, lens, iso, shutter, weight, wifi, bluetooth
{% endcomment %}

{% assign featured_json = product.metafields.product_bridge.featured.value %}

{% if featured_json != blank %}
  <div class="pb-featured" style="
    --pb-heading-color: {{ block.settings.heading_color }};
    --pb-badge-bg: {{ block.settings.badge_bg }};
    --pb-badge-border: {{ block.settings.badge_border }};
    --pb-title-color: {{ block.settings.title_color }};
    --pb-value-color: {{ block.settings.value_color }};
    --pb-accent-color: {{ block.settings.accent_color }};
    --pb-gradient-start: {{ block.settings.gradient_start }};
    --pb-gradient-end: {{ block.settings.gradient_end }};
  ">
    {% if block.settings.heading != blank %}
      <h2 class="pb-featured__heading">
        {% if block.settings.show_heading_icon %}
          <svg class="pb-featured__heading-icon" viewBox="0 0 24 24" width="24" height="24" aria-hidden="true">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
          </svg>
        {% endif %}
        {{ block.settings.heading }}
      </h2>
    {% endif %}

    {% assign specs = featured_json %}
    
    <div class="pb-featured__grid pb-featured__grid--{{ block.settings.style }}">
      {% for spec in specs %}
        <div class="pb-featured__badge {% if block.settings.enable_gradient %}pb-featured__badge--gradient{% endif %}">
          {% if block.settings.show_icons %}
            <div class="pb-featured__icon-wrap">
              {% case spec.icon %}
                {% when 'camera' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="13" r="4" fill="none" stroke="currentColor" stroke-width="2"/>
                  </svg>
                {% when 'video' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="2" y="5" width="20" height="14" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="3" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="18" cy="8" r="1" fill="currentColor"/>
                  </svg>
                {% when 'sensor' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <rect x="8" y="8" width="8" height="8" fill="none" stroke="currentColor" stroke-width="2"/>
                  </svg>
                {% when 'resolution' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="2" y="3" width="20" height="14" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M8 21h8M12 17v4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                {% when 'battery' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="2" y="7" width="18" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M22 11v2" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    <rect x="5" y="10" width="8" height="4" fill="currentColor"/>
                  </svg>
                {% when 'memory' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M8 2v2M12 2v2M16 2v2M8 20v2M12 20v2M16 20v2M2 8h2M2 12h2M2 16h2M20 8h2M20 12h2M20 16h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                {% when 'processor' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="4" y="4" width="16" height="16" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <rect x="9" y="9" width="6" height="6" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M9 1v3M15 1v3M9 20v3M15 20v3M1 9h3M1 15h3M20 9h3M20 15h3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                {% when 'display' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <rect x="2" y="3" width="20" height="14" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M8 21h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M12 17v4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                {% when 'lens' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="6" fill="none" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="12" r="2" fill="currentColor"/>
                  </svg>
                {% when 'iso' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 6v6l4 2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
                {% when 'shutter' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M14.31 8l5.74 9.94M9.69 8h11.48M7.38 12l5.74-9.94M9.69 16L3.95 6.06M14.31 16H2.83M16.62 12l-5.74 9.94" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                {% when 'weight' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M3 6h18" stroke="currentColor" stroke-width="2"/>
                    <circle cx="12" cy="14" r="3" fill="none" stroke="currentColor" stroke-width="2"/>
                  </svg>
                {% when 'wifi' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M5 12.55a11 11 0 0 1 14.08 0M1.42 9a16 16 0 0 1 21.16 0M8.53 16.11a6 6 0 0 1 6.95 0" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <circle cx="12" cy="20" r="1" fill="currentColor"/>
                  </svg>
                {% when 'bluetooth' %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M6.5 6.5l11 11L12 23V1l5.5 5.5-11 11" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                {% else %}
                  <svg class="pb-featured__icon" viewBox="0 0 24 24" aria-hidden="true">
                    <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                  </svg>
              {% endcase %}
            </div>
          {% endif %}
          <div class="pb-featured__content">
            <span class="pb-featured__title">{{ spec.title }}</span>
            <span class="pb-featured__value">{{ spec.value }}</span>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% elsif request.design_mode %}
  <div class="pb-featured pb-featured--placeholder">
    <p class="pb-featured__empty">Featured Specs will display here when data is available.</p>
  </div>
{% endif %}

<style>
  .pb-featured {
    font-family: inherit;
    margin: {{ block.settings.margin_top }}px 0 {{ block.settings.margin_bottom }}px;
  }
  
  .pb-featured__heading {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: {{ block.settings.heading_size }}px;
    font-weight: 700;
    margin: 0 0 1.25rem;
    color: var(--pb-heading-color);
    letter-spacing: -0.02em;
  }
  
  .pb-featured__heading-icon {
    color: var(--pb-accent-color);
    animation: pb-starPulse 2s ease-in-out infinite;
  }
  
  @keyframes pb-starPulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
  }
  
  .pb-featured__grid {
    display: grid;
    gap: {{ block.settings.gap }}px;
  }
  
  .pb-featured__grid--card {
    grid-template-columns: repeat(auto-fit, minmax({{ block.settings.min_width }}px, 1fr));
  }
  
  .pb-featured__grid--pill {
    display: flex;
    flex-wrap: wrap;
  }
  
  .pb-featured__badge {
    display: flex;
    gap: 0.875rem;
    background: var(--pb-badge-bg);
    border: {{ block.settings.border_width }}px solid var(--pb-badge-border);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  
  .pb-featured__grid--card .pb-featured__badge {
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 1.5rem 1.25rem;
    border-radius: {{ block.settings.border_radius }}px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.08);
  }
  
  .pb-featured__grid--pill .pb-featured__badge {
    flex-direction: row;
    align-items: center;
    padding: 0.75rem 1.25rem;
    border-radius: 100px;
  }
  
  /* Hover effect */
  .pb-featured__badge:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08);
    border-color: var(--pb-accent-color);
  }
  
  /* Gradient variant */
  .pb-featured__badge--gradient {
    background: linear-gradient(135deg, var(--pb-gradient-start) 0%, var(--pb-gradient-end) 100%);
    border-color: transparent;
  }
  
  .pb-featured__badge--gradient::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent 0%, rgba(255, 255, 255, 0.2) 100%);
    pointer-events: none;
  }
  
  .pb-featured__icon-wrap {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .pb-featured__grid--card .pb-featured__icon-wrap {
    width: {{ block.settings.icon_size | plus: 16 }}px;
    height: {{ block.settings.icon_size | plus: 16 }}px;
    background: color-mix(in srgb, var(--pb-accent-color) 12%, transparent);
    border-radius: 50%;
    margin-bottom: 0.5rem;
  }
  
  .pb-featured__badge--gradient .pb-featured__icon-wrap {
    background: rgba(255, 255, 255, 0.25);
  }
  
  .pb-featured__icon {
    width: {{ block.settings.icon_size }}px;
    height: {{ block.settings.icon_size }}px;
    color: var(--pb-accent-color);
  }
  
  .pb-featured__badge--gradient .pb-featured__icon {
    color: #fff;
  }
  
  .pb-featured__content {
    display: flex;
    flex-direction: column;
  }
  
  .pb-featured__grid--card .pb-featured__content {
    align-items: center;
    gap: 0.25rem;
  }
  
  .pb-featured__grid--pill .pb-featured__content {
    gap: 0.25rem;
  }
  
  .pb-featured__title {
    font-size: {{ block.settings.title_size }}px;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--pb-title-color);
    font-weight: 600;
  }
  
  .pb-featured__badge--gradient .pb-featured__title {
    color: rgba(255, 255, 255, 0.85);
  }
  
  .pb-featured__value {
    font-size: {{ block.settings.value_size }}px;
    font-weight: 800;
    color: var(--pb-value-color);
    line-height: 1.1;
    letter-spacing: -0.02em;
  }
  
  .pb-featured__badge--gradient .pb-featured__value {
    color: #fff;
  }
  
  .pb-featured__empty,
  .pb-featured--placeholder {
    padding: 2rem;
    color: #999;
    font-style: italic;
    text-align: center;
    border: 2px dashed #ddd;
    border-radius: 8px;
  }
  
  @media (max-width: 640px) {
    .pb-featured__grid--card {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .pb-featured__grid--pill {
      {% if block.settings.mobile_wrap %}
        flex-wrap: wrap;
      {% else %}
        flex-wrap: nowrap;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: none;
        -ms-overflow-style: none;
        padding-bottom: 0.5rem;
      {% endif %}
    }
    
    {% unless block.settings.mobile_wrap %}
      .pb-featured__grid--pill::-webkit-scrollbar {
        display: none;
      }
    {% endunless %}
    
    .pb-featured__grid--card .pb-featured__badge {
      padding: 1.25rem 1rem;
    }
    
    .pb-featured__grid--pill .pb-featured__badge {
      flex-shrink: 0;
    }
    
    .pb-featured__value {
      font-size: calc({{ block.settings.value_size }}px - 2px);
    }
  }
</style>

{% schema %}
{
  "name": "Featured Specs",
  "target": "section",
  "enabled_on": {
    "templates": ["product"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Key Specifications"
    },
    {
      "type": "checkbox",
      "id": "show_heading_icon",
      "label": "Show heading icon",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_icons",
      "label": "Show spec icons",
      "info": "Icons defined in metafield: camera, video, sensor, resolution, battery, memory, processor, display, lens, iso, shutter, weight, wifi, bluetooth",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "style",
      "label": "Style",
      "options": [
        { "value": "card", "label": "Cards (grid)" },
        { "value": "pill", "label": "Pills (inline)" }
      ],
      "default": "card"
    },
    {
      "type": "checkbox",
      "id": "enable_gradient",
      "label": "Enable gradient backgrounds",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "mobile_wrap",
      "label": "Wrap on mobile",
      "info": "When off, badges scroll horizontally on mobile",
      "default": true
    },
    {
      "type": "range",
      "id": "gap",
      "min": 8,
      "max": 24,
      "step": 4,
      "unit": "px",
      "label": "Gap between badges",
      "default": 16
    },
    {
      "type": "range",
      "id": "min_width",
      "min": 100,
      "max": 200,
      "step": 10,
      "unit": "px",
      "label": "Minimum badge width (cards)",
      "default": 140
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 24,
      "step": 2,
      "unit": "px",
      "label": "Border radius (cards)",
      "default": 12
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 0,
      "max": 3,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "range",
      "id": "icon_size",
      "min": 18,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Icon size",
      "default": 24
    },
    {
      "type": "header",
      "content": "Typography"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 16,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Heading size",
      "default": 24
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 9,
      "max": 14,
      "step": 1,
      "unit": "px",
      "label": "Label size",
      "default": 11
    },
    {
      "type": "range",
      "id": "value_size",
      "min": 18,
      "max": 36,
      "step": 2,
      "unit": "px",
      "label": "Value size",
      "default": 26
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "margin_top",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Top margin",
      "default": 20
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Bottom margin",
      "default": 20
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "badge_bg",
      "label": "Badge background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "badge_border",
      "label": "Badge border",
      "default": "#e2e8f0"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Label color",
      "default": "#64748b"
    },
    {
      "type": "color",
      "id": "value_color",
      "label": "Value color",
      "default": "#0f172a"
    },
    {
      "type": "color",
      "id": "accent_color",
      "label": "Accent/icon color",
      "default": "#0066cc"
    },
    {
      "type": "header",
      "content": "Gradient (when enabled)"
    },
    {
      "type": "color",
      "id": "gradient_start",
      "label": "Gradient start",
      "default": "#0066cc"
    },
    {
      "type": "color",
      "id": "gradient_end",
      "label": "Gradient end",
      "default": "#0052a3"
    }
  ]
}
{% endschema %}
