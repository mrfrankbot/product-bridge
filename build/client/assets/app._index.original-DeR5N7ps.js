import{y as n,r as s,u as dt,z as mt,j as e,A as ft}from"./components-DKwNRbqV.js";import{M as J,f as ht,T as Be,B as oe,A as Oe,S as pt,D as Ve,b as bt,c as vt,d as Ie,e as Se,a as gt}from"./SearchIcon.svg-Pl61KX6Q.js";import{u as he,T as k,g as Ge,h as fe,a as $,c as U,e as me,j as qe,k as Xe,A as Tt,U as Qe,l as Ye,m as xt,I as V,f as et,n as yt,d as Ct,o as Et,P as tt,b as F,C as Pe,B as W}from"./Page-P-8IetFp.js";import{k as St}from"./context-BRhAIWmx.js";import{F as Fe}from"./FormLayout-CLAstZ-x.js";var at=function(r){return n.createElement("svg",Object.assign({viewBox:"0 0 20 20"},r),n.createElement("path",{d:"M11.5 8.25a.75.75 0 0 1 .75.75v4.25a.75.75 0 0 1-1.5 0v-4.25a.75.75 0 0 1 .75-.75Z"}),n.createElement("path",{d:"M9.25 9a.75.75 0 0 0-1.5 0v4.25a.75.75 0 0 0 1.5 0v-4.25Z"}),n.createElement("path",{fillRule:"evenodd",d:"M7.25 5.25a2.75 2.75 0 0 1 5.5 0h3a.75.75 0 0 1 0 1.5h-.75v5.45c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311c-.642.327-1.482.327-3.162.327h-.4c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311c-.327-.642-.327-1.482-.327-3.162v-5.45h-.75a.75.75 0 0 1 0-1.5h3Zm1.5 0a1.25 1.25 0 1 1 2.5 0h-2.5Zm-2.25 1.5h7v5.45c0 .865-.001 1.423-.036 1.848-.033.408-.09.559-.128.633a1.5 1.5 0 0 1-.655.655c-.074.038-.225.095-.633.128-.425.035-.983.036-1.848.036h-.4c-.865 0-1.423-.001-1.848-.036-.408-.033-.559-.09-.633-.128a1.5 1.5 0 0 1-.656-.655c-.037-.074-.094-.225-.127-.633-.035-.425-.036-.983-.036-1.848v-5.45Z"}))};at.displayName="DeleteIcon";var nt=function(r){return n.createElement("svg",Object.assign({viewBox:"0 0 20 20"},r),n.createElement("path",{d:"M11.25 8.5c-.414 0-.75.336-.75.75v1.25h-1.25c-.414 0-.75.336-.75.75s.336.75.75.75h1.25v1.25c0 .414.336.75.75.75s.75-.336.75-.75v-1.25h1.25c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-1.25v-1.25c0-.414-.336-.75-.75-.75Z"}),n.createElement("path",{fillRule:"evenodd",d:"M8.75 16.5c-1.438 0-2.618-1.104-2.74-2.51-1.406-.122-2.51-1.302-2.51-2.74v-5c0-1.519 1.231-2.75 2.75-2.75h5c1.438 0 2.618 1.104 2.74 2.51 1.406.122 2.51 1.302 2.51 2.74v5c0 1.519-1.231 2.75-2.75 2.75h-5Zm0-10.5c-1.519 0-2.75 1.231-2.75 2.75v3.725c-.57-.116-1-.62-1-1.225v-5c0-.69.56-1.25 1.25-1.25h5c.605 0 1.11.43 1.225 1h-3.725Zm0 1.5c-.69 0-1.25.56-1.25 1.25v5c0 .69.56 1.25 1.25 1.25h5c.69 0 1.25-.56 1.25-1.25v-5c0-.69-.56-1.25-1.25-1.25h-5Z"}))};nt.displayName="DuplicateIcon";var st=function(r){return n.createElement("svg",Object.assign({viewBox:"0 0 20 20"},r),n.createElement("path",{fillRule:"evenodd",d:"M15.655 4.344a2.695 2.695 0 0 0-3.81 0l-.599.599-.009-.009-1.06 1.06.008.01-5.88 5.88a2.75 2.75 0 0 0-.805 1.944v1.922a.75.75 0 0 0 .75.75h1.922a2.75 2.75 0 0 0 1.944-.806l7.54-7.539a2.695 2.695 0 0 0 0-3.81Zm-4.409 2.72-5.88 5.88a1.25 1.25 0 0 0-.366.884v1.172h1.172c.331 0 .65-.132.883-.366l5.88-5.88-1.689-1.69Zm2.75.629.599-.599a1.195 1.195 0 1 0-1.69-1.689l-.598.599 1.69 1.689Z"}))};st.displayName="EditIcon";var ot=function(r){return n.createElement("svg",Object.assign({viewBox:"0 0 20 20"},r),n.createElement("path",{fillRule:"evenodd",d:"M3 6.75c0-2.071 1.679-3.75 3.75-3.75h6.5c2.071 0 3.75 1.679 3.75 3.75v6.5c0 2.071-1.679 3.75-3.75 3.75h-6.5c-2.071 0-3.75-1.679-3.75-3.75v-6.5Zm3.75-2.25c-1.243 0-2.25 1.007-2.25 2.25v6.5c0 1.243 1.007 2.25 2.25 2.25h.5v-11h-.5Zm4.5 11h-2.5v-11h2.5v11Zm1.5 0h.5c1.243 0 2.25-1.007 2.25-2.25v-6.5c0-1.243-1.007-2.25-2.25-2.25h-.5v11Z"}))};ot.displayName="LayoutColumns3Icon";var rt=function(r){return n.createElement("svg",Object.assign({viewBox:"0 0 20 20"},r),n.createElement("path",{d:"M10.75 5.75c0-.414-.336-.75-.75-.75s-.75.336-.75.75v3.5h-3.5c-.414 0-.75.336-.75.75s.336.75.75.75h3.5v3.5c0 .414.336.75.75.75s.75-.336.75-.75v-3.5h3.5c.414 0 .75-.336.75-.75s-.336-.75-.75-.75h-3.5v-3.5Z"}))};rt.displayName="PlusIcon";var Pt={Divider:"Polaris-Divider"};const we=({borderColor:t="border-secondary",borderWidth:r="025"})=>{const o=t==="transparent"?t:`var(--p-color-${t})`;return n.createElement("hr",{className:Pt.Divider,style:{borderBlockStart:`var(--p-border-width-${r}) solid ${o}`}})};function _e({acceptCharset:t,action:r,autoComplete:o,children:b,encType:y,implicitSubmit:E=!0,method:C="post",name:u,noValidate:a,preventDefault:c=!0,target:h,onSubmit:T}){const x=he(),P=s.useCallback(d=>{c&&(d.preventDefault(),T(d))},[T,c]),v=wt(o),A=E?n.createElement(k,{as:"span",visuallyHidden:!0},n.createElement("button",{type:"submit","aria-hidden":"true",tabIndex:-1},x.translate("Polaris.Common.submit"))):null;return n.createElement("form",{acceptCharset:t,action:r,autoComplete:v,encType:y,method:C,name:u,noValidate:a,target:h,onSubmit:P},A,b)}function wt(t){return t==null?t:t?"on":"off"}function jt(){const[t,r]=s.useState(!1),o=s.useCallback(()=>r(!0),[]);return Ge("touchstart",o),t}function $e(t){const r=s.useRef();return s.useEffect(()=>{r.current=t},[t]),r.current}function He(t,r,o,b,y){const E=b.reduce((c,h)=>c+h,0),C=t.map((c,h)=>h),u=[],a=[];if(y>E)u.push(...C);else{u.push(r);let c=b[r];C.forEach(h=>{if(h!==r){const T=b[h];if(c+T>=y-o){a.push(h);return}u.push(h),c+=T}})}return{visibleTabs:u,hiddenTabs:a}}var g={Outer:"Polaris-Tabs__Outer",Wrapper:"Polaris-Tabs__Wrapper",WrapperWithNewButton:"Polaris-Tabs__WrapperWithNewButton",ButtonWrapper:"Polaris-Tabs__ButtonWrapper",Tabs:"Polaris-Tabs",Tab:"Polaris-Tabs__Tab","Tab-active":"Polaris-Tabs__Tab--active","Tab-hasActions":"Polaris-Tabs__Tab--hasActions","Tab-iconOnly":"Polaris-Tabs__Tab--iconOnly",fillSpace:"Polaris-Tabs--fillSpace",TabContainer:"Polaris-Tabs__TabContainer",fitted:"Polaris-Tabs--fitted",List:"Polaris-Tabs__List",Item:"Polaris-Tabs__Item",DisclosureTab:"Polaris-Tabs__DisclosureTab","DisclosureTab-visible":"Polaris-Tabs__DisclosureTab--visible",DisclosureActivator:"Polaris-Tabs__DisclosureActivator",TabsMeasurer:"Polaris-Tabs__TabsMeasurer",NewTab:"Polaris-Tabs__NewTab",ActionListWrap:"Polaris-Tabs__ActionListWrap",Panel:"Polaris-Tabs__Panel","Panel-hidden":"Polaris-Tabs__Panel--hidden"};const Ne=40;function At({open:t,isModalLoading:r,name:o,onClose:b,onClickPrimaryAction:y,onClickSecondaryAction:E,helpText:C,viewNames:u}){const a=he(),[c,h]=s.useState(o),T=s.useRef(null),x=u?.some(S=>S.trim().toLowerCase()===c.trim().toLowerCase()),P=r||x||!c||c.length>Ne;s.useEffect(()=>{T.current&&t&&fe(T.current)},[t]),s.useEffect(()=>{t&&h(o.slice(0,Ne))},[o,t]);const v=s.useCallback(S=>{h(S)},[]);async function A(){P||(await y(c),h(""),b())}function d(){E?.(),h(o),b()}return n.createElement(J,{open:t,onClose:b,title:a.translate("Polaris.Tabs.DuplicateModal.title"),primaryAction:{content:a.translate("Polaris.Tabs.DuplicateModal.create"),onAction:A,disabled:P},secondaryActions:[{content:a.translate("Polaris.Tabs.DuplicateModal.cancel"),onAction:d}],instant:!0},n.createElement(J.Section,null,n.createElement(_e,{onSubmit:A},n.createElement(Fe,null,n.createElement("div",{ref:T},n.createElement($,{label:a.translate("Polaris.Tabs.DuplicateModal.label"),value:c,onChange:v,autoComplete:"off",helpText:C,maxLength:Ne,showCharacterCount:!0,error:x?a.translate("Polaris.Tabs.DuplicateModal.errors.sameName",{name:c}):void 0}))))))}function Mt({open:t,isModalLoading:r,name:o,onClose:b,onClickPrimaryAction:y,onClickSecondaryAction:E,helpText:C,viewNames:u}){const a=he(),[c,h]=s.useState(o),T=s.useRef(null),x=u?.filter(S=>S!==o).some(S=>S.trim().toLowerCase()===c.trim().toLowerCase()),P=r||x||c===o||!c;s.useEffect(()=>{T.current&&t&&fe(T.current)},[t]),s.useEffect(()=>{t&&h(o)},[o,t]);const v=s.useCallback(S=>{h(S)},[]);async function A(){P||(await y(c),h(""),b())}function d(){E?.(),h(o),b()}return n.createElement(J,{open:t,onClose:b,title:a.translate("Polaris.Tabs.RenameModal.title"),primaryAction:{content:a.translate("Polaris.Tabs.RenameModal.create"),onAction:A,disabled:P},secondaryActions:[{content:a.translate("Polaris.Tabs.RenameModal.cancel"),onAction:d}],instant:!0},n.createElement(J.Section,null,n.createElement(_e,{onSubmit:A},n.createElement(Fe,null,n.createElement("div",{ref:T},n.createElement($,{label:a.translate("Polaris.Tabs.RenameModal.label"),value:c,onChange:v,autoComplete:"off",helpText:C,maxLength:40,showCharacterCount:!0,error:x?a.translate("Polaris.Tabs.RenameModal.errors.sameName",{name:c}):void 0}))))))}const je=s.forwardRef(({content:t,accessibilityLabel:r,badge:o,id:b,panelID:y,url:E,onAction:C,actions:u,disabled:a,isModalLoading:c,icon:h,siblingTabHasFocus:T,measuring:x,focused:P,selected:v,onToggleModal:A,onTogglePopover:d,viewNames:S,tabIndexOverride:w,onFocus:X},H)=>{const D=he(),[I,re]=s.useState(!1),[B,ae]=s.useState(null),ne=s.useRef(v),_=s.useRef(!1),R=s.useRef(null);s.useEffect(()=>{d(I)},[I,d]),s.useEffect(()=>{A(!!B)},[B,A]),s.useEffect(()=>()=>{A(!1),d(!1)},[A,d]),s.useEffect(()=>{if(x)return;(P||document.activeElement&&document.activeElement.id===b)&&v&&y!=null&&!_.current&&(Ze(y),_.current=!0),v&&!ne.current&&y!=null?Ze(y):P&&R.current!=null&&B==null&&!a&&fe(R.current),ne.current=v},[P,b,t,x,y,v,B,a]);let K;v&&!T&&!x||P&&!x?K=0:K=-1,w!=null&&(K=w);const Q=u?.find(j=>j.type==="rename"),G=u?.find(j=>j.type==="duplicate"),z=u?.find(j=>j.type==="delete"),Y=s.useCallback(()=>{u?.length&&re(j=>!j)},[u]),se=s.useCallback(()=>{a||(v?Y():C?.())},[v,C,Y,a]),le=j=>{ae(j)},Z=()=>{ae(null)},pe=s.useCallback(async j=>{await Q?.onPrimaryAction?.(j),setTimeout(()=>{R.current&&fe(R.current)},250)},[Q]),ie=s.useCallback(async()=>{await z?.onPrimaryAction?.(t),Z()},[z,t]),be=s.useCallback(async j=>{await G?.onPrimaryAction?.(j)},[G]),ve={rename:{icon:ht,content:D.translate("Polaris.Tabs.Tab.rename")},duplicate:{icon:nt,content:D.translate("Polaris.Tabs.Tab.duplicate")},edit:{icon:st,content:D.translate("Polaris.Tabs.Tab.edit")},"edit-columns":{icon:ot,content:D.translate("Polaris.Tabs.Tab.editColumns")},delete:{icon:at,content:D.translate("Polaris.Tabs.Tab.delete"),destructive:!0}},l=u?.map(({type:j,onAction:ke,onPrimaryAction:lt,...Ce})=>{const De=!j.includes("edit");return{...ve[j],...Ce,onAction:()=>{ke?.(t),Y(),De&&le(j)}}}),m=s.useCallback(j=>{j.key===" "&&(j.preventDefault(),se())},[se]),p=U(g.TabContainer,v&&g.Underline),M=a||v?void 0:E,L=M?Qe:Ye,ce=U(g.Tab,h&&g["Tab-iconOnly"],I&&g["Tab-popoverActive"],v&&g["Tab-active"],v&&u?.length&&g["Tab-hasActions"]),ge=o?n.createElement(et,{tone:v?void 0:"new"},o):null,Te=v&&u?.length?n.createElement("div",{className:U(g.IconWrap)},n.createElement(me,{source:qe})):null,ue=n.createElement(L,{id:b,className:ce,tabIndex:K,"aria-selected":v,"aria-controls":y,"aria-label":r,role:w==null?"tab":void 0,disabled:a,url:M,onFocus:X,onMouseUp:xt,onClick:se,onKeyDown:m},n.createElement(V,{gap:"200",align:"center",blockAlign:"center",wrap:!1},n.createElement(k,{as:"span",variant:"bodySm",fontWeight:"medium"},h??t),ge),Te),xe=!v||!u?.length,de=Q?n.createElement(Mt,{name:t,open:B==="rename",onClose:Z,onClickPrimaryAction:pe,isModalLoading:c,viewNames:S}):null,Ae=G?n.createElement(At,{open:B==="duplicate",name:D.translate("Polaris.Tabs.Tab.copy",{name:t}),onClose:Z,onClickPrimaryAction:be,isModalLoading:c,viewNames:S||[]}):null,Me=z?n.createElement(J,{open:B==="delete",onClose:Z,primaryAction:{content:D.translate("Polaris.Tabs.Tab.deleteModal.delete"),onAction:ie,destructive:!0,disabled:c},secondaryActions:[{content:D.translate("Polaris.Tabs.Tab.deleteModal.cancel"),onAction:Z}],title:D.translate("Polaris.Tabs.Tab.deleteModal.title"),instant:!0},n.createElement(J.Section,null,D.translate("Polaris.Tabs.Tab.deleteModal.description",{viewName:t}))):null,ye=xe||a?ue:n.createElement(n.Fragment,null,n.createElement(Xe,{active:I,activator:ue,autofocusTarget:"first-node",onClose:Y},n.createElement("div",{className:g.ActionListWrap},n.createElement(Tt,{actionRole:"menuitem",items:l}))),de,Ae,Me);return h?ye:n.createElement("li",{className:p,ref:kt([R,H]),role:"presentation"},ye)});je.displayName="Tab";function Ze(t){const r=document.getElementById(t);r&&r.focus({preventScroll:!0})}function kt(t){return r=>{for(const o of t)o!=null&&(o.current=r)}}const Dt=s.memo(function({selected:r,tabs:o,activator:b,tabToFocus:y,siblingTabHasFocus:E,handleMeasurement:C}){const u=s.useRef(null),a=s.useRef(null),c=s.useCallback(()=>{a.current&&cancelAnimationFrame(a.current),a.current=requestAnimationFrame(()=>{if(!u.current)return;const x=u.current.offsetWidth-20-28,P=u.current.children,A=Array.from(P).map(S=>Math.ceil(S.getBoundingClientRect().width)+4),d=A.pop()||0;C({containerWidth:x,disclosureWidth:d,hiddenTabWidths:A})})},[C]);s.useEffect(()=>{c()},[c,o]),yt(()=>{});const h=o.map((x,P)=>n.createElement(je,{measuring:!0,key:`$${x.id}Hidden`,id:`${x.id}Measurer`,siblingTabHasFocus:E,focused:P===y,selected:P===r,url:x.url,content:x.content,onTogglePopover:Ue,onToggleModal:Ue})),T=U(g.Tabs,g.TabsMeasurer);return Ge("resize",c),n.createElement("div",{className:T,ref:u},h,b)});function Ue(){}function Ke({hidden:t,id:r,tabID:o,children:b}){const y=U(g.Panel,t&&g["Panel-hidden"]);return n.createElement("div",{className:y,id:r,role:"tabpanel","aria-labelledby":o,tabIndex:-1},b)}const It=s.memo(function({id:r,focused:o,children:b,url:y,accessibilityLabel:E,onClick:C=Nt}){const u=s.useRef(null);s.useEffect(()=>{u.current&&u.current instanceof HTMLElement&&o&&u.current.focus()},[u,o]);const a=U(g.Item),c={id:r,ref:u,onClick:C,className:a,"aria-selected":!1,"aria-label":E},h=y?n.createElement(Qe,Object.assign({},c,{url:y}),b):n.createElement("button",Object.assign({},c,{ref:u,type:"button"}),b);return n.createElement("li",null,h)});function Nt(){}function Ft({focusIndex:t,disclosureTabs:r,onClick:o=ze,onKeyPress:b=ze}){const y=r.map(({id:E,content:C,...u},a)=>n.createElement(It,Object.assign({key:E},u,{id:E,focused:a===t,onClick:o.bind(null,E)}),C));return n.createElement("ul",{className:g.List,onKeyDown:_t,onKeyUp:b},y)}function ze(){}function _t(t){const{key:r}=t;(r==="ArrowLeft"||r==="ArrowRight")&&(t.preventDefault(),t.stopPropagation())}const Je=40;function Lt({activator:t,open:r,onClose:o,onClickPrimaryAction:b,onClickSecondaryAction:y,viewNames:E}){const C=he(),[u,a]=s.useState(""),[c,h]=s.useState(!1),T=s.useRef(null),x=jt(),P=E.some(w=>w.trim().toLowerCase()===u.trim().toLowerCase()),v=!u||P||c||u.length>Je;s.useEffect(()=>{if(!(!T.current||x)&&r){fe(T.current);const w=setTimeout(()=>{T.current&&fe(T.current)},50);return()=>clearTimeout(w)}},[r,x]);const A=s.useCallback(w=>{a(w)},[]);async function d(){P||v||(h(!0),await b(u),h(!1),a(""),o())}function S(){y?.(),a(""),o()}return n.createElement(J,{activator:t,open:r,onClose:o,title:C.translate("Polaris.Tabs.CreateViewModal.title"),primaryAction:{content:C.translate("Polaris.Tabs.CreateViewModal.create"),onAction:d,disabled:v},secondaryActions:[{content:C.translate("Polaris.Tabs.CreateViewModal.cancel"),onAction:S}]},n.createElement(J.Section,null,n.createElement(_e,{onSubmit:d},n.createElement(Fe,null,n.createElement("div",{ref:T},n.createElement($,{label:C.translate("Polaris.Tabs.CreateViewModal.label"),value:u,onChange:A,autoComplete:"off",maxLength:Je,showCharacterCount:!0,error:P?C.translate("Polaris.Tabs.CreateViewModal.errors.sameName",{name:u}):void 0}))))))}const Rt="create-new-view",Wt=({tabs:t,children:r,selected:o,newViewAccessibilityLabel:b,canCreateNewView:y,disabled:E,onCreateNewView:C,onSelect:u,fitted:a,disclosureText:c})=>{const h=he(),{mdDown:T}=St(),x=s.useRef(null),P=s.useRef(null),v=s.useRef(null),[A,d]=s.useReducer((i,f)=>({...i,...f}),{disclosureWidth:0,containerWidth:1/0,tabWidths:[],visibleTabs:[],hiddenTabs:[],showDisclosure:!1,tabToFocus:-1,isNewViewModalActive:!1,modalSubmitted:!1,isTabsFocused:!1,isTabPopoverOpen:!1,isTabModalOpen:!1}),{tabToFocus:S,visibleTabs:w,hiddenTabs:X,showDisclosure:H,isNewViewModalActive:D,modalSubmitted:I,disclosureWidth:re,tabWidths:B,containerWidth:ae,isTabsFocused:ne,isTabModalOpen:_,isTabPopoverOpen:R}=A,K=$e(_),Q=$e(R);s.useEffect(()=>{K&&!_?d({isTabsFocused:!0,tabToFocus:o}):Q&&!R&&!_&&d({isTabsFocused:!0,tabToFocus:o})},[Q,R,K,_,o,S]);const G=s.useCallback(i=>d({isTabPopoverOpen:i}),[]),z=s.useCallback(i=>d({isTabModalOpen:i}),[]),Y=()=>{d({isNewViewModalActive:!1})},se=async i=>{if(!C)return!1;const f=await C?.(i);return f&&d({modalSubmitted:!0}),f},le=()=>{d({isNewViewModalActive:!0})},Z=s.useCallback(i=>{const f=t.find(O=>O.id===i);if(f==null)return null;const N=t.indexOf(f);u?.(N)},[t,u]),pe=s.useCallback((i,f)=>{const N=()=>{Z(i.id),i.onAction?.()},O=t.map(({content:ee})=>ee),q=i.panelID||`${i.id}-panel`;return n.createElement(je,Object.assign({},i,{key:`${f}-${i.id}`,id:i.id,panelID:r?q:void 0,disabled:E||i.disabled,siblingTabHasFocus:S>-1,focused:f===S,selected:f===o,onAction:N,accessibilityLabel:i.accessibilityLabel,url:i.url,content:i.content,onToggleModal:z,onTogglePopover:G,viewNames:O,ref:f===o?v:null}))},[E,Z,t,r,o,S,z,G]),ie=s.useCallback(i=>{const f=i.target,N=f.classList.contains(g.Item),O=f.closest("[data-tabs-focus-catchment]")||N;f.classList.contains(g.DisclosureActivator)||!O||d({isTabsFocused:!0})},[]),be=s.useCallback(i=>{const f=i.target,N=i.relatedTarget,O=N?.closest?.(`.${g.Tabs}`),q=f?.classList?.contains?.(g.Tab),ee=N?.classList.contains(g.Item);if(!N&&!_&&!q&&!ee){d({tabToFocus:-1});return}if(!O&&!_&&!q&&!ee){d({tabToFocus:-1});return}d({isTabsFocused:!1})},[_]),ve=i=>{if(R||_||D)return;const{key:f}=i;(f==="ArrowLeft"||f==="ArrowRight")&&(i.preventDefault(),i.stopPropagation())};s.useEffect(()=>{const{visibleTabs:i,hiddenTabs:f}=He(t,o,re,B,ae);d({visibleTabs:i,hiddenTabs:f})},[ae,re,t,o,B,d]);const l=s.useCallback(()=>{const i=v.current?.querySelector(`.${g["Tab-active"]}`);i&&ge(i.offsetLeft)},[]);s.useEffect(()=>{T&&l()},[l,o,T]),s.useEffect(()=>{ne&&!H&&d({tabToFocus:o})},[ne,o,d,H]);const m=i=>{const{showDisclosure:f,visibleTabs:N,hiddenTabs:O,tabToFocus:q,isNewViewModalActive:ee}=A;if(_||R||ee)return;const Re=i.key,Ee=f||T?N.concat(O):[...N];let te=Ee.indexOf(q);Re==="ArrowRight"&&(te+=1,te===Ee.length&&(te=0)),Re==="ArrowLeft"&&(te===-1||te===0?te=Ee.length-1:te-=1);const We=Ee[te];We!=null&&d({tabToFocus:We})},p=()=>{d({showDisclosure:!H,tabToFocus:X[0]})},M=()=>{d({showDisclosure:!1})},L=s.useCallback(i=>{const{hiddenTabWidths:f,containerWidth:N,disclosureWidth:O}=i,{visibleTabs:q,hiddenTabs:ee}=He(t,o,O,f,N);d({visibleTabs:q,hiddenTabs:ee,disclosureWidth:O,containerWidth:N,tabWidths:f})},[t,o,d]),ce=i=>{Z(i),M(),d({isTabsFocused:!0})},ge=i=>{setTimeout(()=>{if(x.current&&typeof x.current.scroll=="function"){const f=P?.current?.offsetLeft||0;x?.current?.scroll({left:i-f})}},0)},Te=b||h.translate("Polaris.Tabs.newViewAccessibilityLabel"),ue=T?[...w,...X]:w,xe=ue.sort((i,f)=>i-f).filter(i=>t[i]).map(i=>pe(t[i],i)),de=w.length<t.length&&!T,Ae=U(g.Tabs,a&&g.fitted,de&&g.fillSpace),Me=U(g.Wrapper,y&&g.WrapperWithNewButton),ye=U(g.DisclosureTab,de&&g["DisclosureTab-visible"]),j=U(g.DisclosureActivator),ke=n.createElement(n.Fragment,null,n.createElement(k,{as:"span",variant:"bodySm",fontWeight:"medium"},c??h.translate("Polaris.Tabs.toggleTabsLabel")),n.createElement("div",{className:U(g.IconWrap,de&&H&&g["IconWrap-open"])},n.createElement(me,{source:qe,tone:"subdued"}))),Ce=n.createElement(Ye,{type:"button",className:j,onClick:p,"aria-label":c??h.translate("Polaris.Tabs.toggleTabsLabel"),disabled:E},ke),De=X.map(i=>t[i]),it=t.map(({content:i})=>i),ct=n.createElement(Dt,{tabToFocus:S,activator:Ce,selected:o,tabs:t,siblingTabHasFocus:S>-1,handleMeasurement:L}),Le=n.createElement(je,{id:Rt,content:Te,actions:[],onAction:le,onFocus:()=>{I&&d({tabToFocus:o,modalSubmitted:!1})},icon:n.createElement(me,{source:rt,accessibilityLabel:Te}),disabled:E,onTogglePopover:G,onToggleModal:z,tabIndexOverride:0}),ut=r?t.map((i,f)=>o===f?n.createElement(Ke,{id:t[f].panelID||`${t[f].id}-panel`,tabID:t[f].id,key:t[f].id},r):n.createElement(Ke,{id:t[f].panelID||`${t[f].id}-panel`,tabID:t[f].id,key:t[f].id,hidden:!0})):null;return n.createElement("div",{className:g.Outer},n.createElement(Ct,{padding:{md:"200"}},ct,n.createElement("div",{className:Me,ref:x},n.createElement("div",{className:g.ButtonWrapper,ref:P},n.createElement("ul",{role:xe.length>0?"tablist":void 0,className:Ae,onFocus:ie,onBlur:be,onKeyDown:ve,onKeyUp:m,"data-tabs-focus-catchment":!0},xe,T||ue.length===0?null:n.createElement("li",{className:ye,role:"presentation"},n.createElement(Xe,{preferredPosition:"below",preferredAlignment:"left",activator:Ce,active:de&&H,onClose:M,autofocusTarget:"first-node"},n.createElement(Ft,{focusIndex:X.indexOf(S),disclosureTabs:De,onClick:ce,onKeyPress:m})))),y&&ue.length>0?n.createElement("div",{className:g.NewTab},n.createElement(Lt,{open:D,onClose:Y,onClickPrimaryAction:se,viewNames:it,activator:E?Le:n.createElement("div",null,n.createElement(Et,{content:h.translate("Polaris.Tabs.newViewTooltip"),preferredPosition:"above",hoverDelay:400},Le))})):null))),ut)};function Zt(){const{products:t}=dt(),r=mt();s.useRef(null);const[o,b]=s.useState(null),[y,E]=s.useState(""),[C,u]=s.useState(""),[a,c]=s.useState(null),[h,T]=s.useState(!1),[x,P]=s.useState(0),[v,A]=s.useState(""),[d,S]=s.useState(null),[w,X]=s.useState(null),H=r.state==="submitting"&&(r.formData?.get("intent")==="extract"||r.formData?.get("intent")==="extract-pdf"||r.formData?.get("intent")==="extract-url"),D=r.state==="submitting"&&r.formData?.get("intent")==="save",I=r.data;s.useEffect(()=>{I?.extracted&&(c(I.extracted),I.source&&X(I.source))},[I]);const re=s.useCallback((l,m)=>{m.length>0&&S(m[0])},[]),B=()=>{if(!d)return;const l=new FormData;l.append("intent","extract-pdf"),l.append("pdf",d),r.submit(l,{method:"post",encType:"multipart/form-data"})},ae=()=>{if(!v.trim())return;const l=new FormData;l.append("intent","extract-url"),l.append("url",v.trim()),r.submit(l,{method:"post"})},ne=[{id:"text",content:"ðŸ“ Paste Text"},{id:"pdf",content:"ðŸ“„ Upload PDF"},{id:"url",content:"ðŸ”— Scrape URL"}],_=t.map(l=>({value:l.id,label:l.title,media:l.featuredImage?.url?e.jsx(Be,{source:l.featuredImage.url,alt:l.featuredImage.altText||l.title,size:"small"}):void 0})),R=s.useCallback(l=>{const m=t.find(p=>p.id===l[0]);m&&(b(m),E(m.title))},[t]),K=(l,m)=>{if(!a)return;const p=[...a.highlights];p[l]=m,c({...a,highlights:p})},Q=l=>{a&&c({...a,highlights:a.highlights.filter((m,p)=>p!==l)})},G=()=>{a&&c({...a,highlights:[...a.highlights,""]})},z=(l,m,p)=>{if(!a)return;const M=[...a.featured];M[l]={...M[l],[m]:p},c({...a,featured:M})},Y=l=>{a&&c({...a,featured:a.featured.filter((m,p)=>p!==l)})},se=()=>{a&&c({...a,featured:[...a.featured,{title:"",value:""}]})},le=(l,m,p)=>{if(!a)return;const M=[...a.included];M[l]={...M[l],[m]:p},c({...a,included:M})},Z=l=>{a&&c({...a,included:a.included.filter((m,p)=>p!==l)})},pe=()=>{a&&c({...a,included:[...a.included,{title:"",link:""}]})},ie=(l,m,p,M)=>{if(!a)return;const L=[...a.specs];L[l]={...L[l],lines:L[l].lines.map((ce,ge)=>ge===m?{...ce,[p]:M}:ce)},c({...a,specs:L})},be=(l,m)=>{if(!a)return;const p=[...a.specs];p[l]={...p[l],lines:p[l].lines.filter((M,L)=>L!==m)},c({...a,specs:p})},ve=()=>{if(!o||!a)return;const l=new FormData;l.append("intent","save"),l.append("productId",o.id),l.append("content",JSON.stringify(a)),r.submit(l,{method:"post"})};return e.jsx(tt,{title:"Product Bridge",subtitle:"AI-powered product content automation",children:e.jsxs(F,{gap:"400",children:[I?.success&&e.jsx(oe,{title:"Metafields saved successfully!",tone:"success",onDismiss:()=>{}}),I?.error&&e.jsx(oe,{title:"Error",tone:"critical",children:I.error}),e.jsx(Pe,{children:e.jsxs(F,{gap:"400",children:[e.jsx(k,{as:"h2",variant:"headingMd",children:"Step 1: Select Product"}),e.jsx(Oe,{options:_,selected:o?[o.id]:[],onSelect:R,textField:e.jsx(Oe.TextField,{onChange:E,label:"Search products",value:y,prefix:e.jsx(me,{source:pt}),placeholder:"Start typing to search...",autoComplete:"off"})}),o&&e.jsxs(V,{gap:"400",align:"start",blockAlign:"center",children:[o.featuredImage?.url&&e.jsx(Be,{source:o.featuredImage.url,alt:o.title,size:"medium"}),e.jsxs(F,{gap:"100",children:[e.jsx(k,{as:"p",variant:"bodyMd",fontWeight:"semibold",children:o.title}),e.jsxs(k,{as:"p",variant:"bodySm",tone:"subdued",children:["ID: ",o.id.replace("gid://shopify/Product/","")]})]}),e.jsx(et,{tone:"info",children:"Selected"})]})]})}),e.jsx(Pe,{children:e.jsxs(F,{gap:"400",children:[e.jsx(k,{as:"h2",variant:"headingMd",children:"Step 2: Import Product Specs"}),e.jsx(Wt,{tabs:ne,selected:x,onSelect:P}),x===0&&e.jsxs(F,{gap:"400",children:[e.jsx($,{label:"Raw specs from manufacturer",multiline:8,value:C,onChange:u,placeholder:"Paste the full specification sheet from the manufacturer website...",autoComplete:"off"}),e.jsxs(r.Form,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"extract"}),e.jsx("input",{type:"hidden",name:"text",value:C}),e.jsx(W,{variant:"primary",submit:!0,loading:H,disabled:!C.trim(),children:"Extract Content with AI"})]})]}),x===1&&e.jsxs(F,{gap:"400",children:[e.jsx(Ve,{onDrop:re,accept:".pdf,application/pdf",type:"file",allowMultiple:!1,children:d?e.jsxs(F,{gap:"200",inlineAlign:"center",children:[e.jsx(me,{source:bt,tone:"success"}),e.jsx(k,{as:"p",variant:"bodyMd",fontWeight:"semibold",children:d.name}),e.jsxs(k,{as:"p",variant:"bodySm",tone:"subdued",children:[(d.size/1024/1024).toFixed(2)," MB"]}),e.jsx(W,{variant:"plain",onClick:()=>S(null),children:"Remove"})]}):e.jsx(Ve.FileUpload,{actionTitle:"Upload PDF",actionHint:"or drag and drop"})}),e.jsx(V,{gap:"200",children:e.jsx(W,{variant:"primary",onClick:B,loading:H&&r.formData?.get("intent")==="extract-pdf",disabled:!d,children:"Extract Content from PDF"})}),e.jsx(oe,{tone:"info",children:e.jsx(k,{as:"p",variant:"bodySm",children:"Upload manufacturer spec sheets or product brochures. Works best with text-based PDFs. Image-only PDFs may not extract correctly."})})]}),x===2&&e.jsxs(F,{gap:"400",children:[e.jsx($,{label:"Manufacturer product page URL",value:v,onChange:A,placeholder:"https://www.usa.canon.com/shop/p/eos-r5-mark-ii",autoComplete:"off",prefix:e.jsx(me,{source:vt})}),e.jsx(W,{variant:"primary",onClick:ae,loading:H&&r.formData?.get("intent")==="extract-url",disabled:!v.trim(),children:"Scrape & Extract Content"}),e.jsx(oe,{tone:"info",children:e.jsx(k,{as:"p",variant:"bodySm",children:"Supported manufacturers: Canon, Sony, Nikon, Fujifilm, Panasonic, Leica, Sigma, Tamron, DJI, GoPro, and more. Works best with product specification pages."})})]}),w&&a&&e.jsx(oe,{tone:"success",children:e.jsxs(F,{gap:"100",children:[e.jsx(k,{as:"p",variant:"bodySm",fontWeight:"semibold",children:"Content extracted successfully!"}),w.type==="pdf"&&e.jsxs(k,{as:"p",variant:"bodySm",children:["Source: ",w.filename," (",w.pages," pages)"]}),w.type==="url"&&e.jsxs(k,{as:"p",variant:"bodySm",children:["Source: ",w.title||w.url,w.manufacturer&&` (${w.manufacturer})`]})]})})]})}),a&&e.jsx(Pe,{children:e.jsxs(F,{gap:"500",children:[e.jsxs(V,{align:"space-between",children:[e.jsx(k,{as:"h2",variant:"headingMd",children:"Step 3: Review & Edit Content"}),e.jsx(W,{variant:"tertiary",onClick:()=>T(!0),children:"Preview JSON"})]}),e.jsxs(F,{gap:"300",children:[e.jsxs(V,{align:"space-between",children:[e.jsxs(k,{as:"h3",variant:"headingSm",children:["Highlights (",a.highlights.length,")"]}),e.jsx(W,{variant:"plain",onClick:G,icon:Ie,children:"Add"})]}),a.highlights.map((l,m)=>e.jsxs(V,{gap:"200",align:"start",blockAlign:"center",children:[e.jsx("div",{style:{flex:1},children:e.jsx($,{label:"",labelHidden:!0,value:l,onChange:p=>K(m,p),autoComplete:"off"})}),e.jsx(W,{variant:"plain",tone:"critical",onClick:()=>Q(m),icon:Se})]},m))]}),e.jsx(we,{}),e.jsxs(F,{gap:"300",children:[e.jsxs(V,{align:"space-between",children:[e.jsxs(k,{as:"h3",variant:"headingSm",children:["Featured Specs (",a.featured.length,")"]}),e.jsx(W,{variant:"plain",onClick:se,icon:Ie,children:"Add"})]}),a.featured.map((l,m)=>e.jsxs(V,{gap:"200",align:"start",blockAlign:"end",children:[e.jsx("div",{style:{flex:1},children:e.jsx($,{label:"Title",value:l.title,onChange:p=>z(m,"title",p),autoComplete:"off"})}),e.jsx("div",{style:{flex:1},children:e.jsx($,{label:"Value",value:l.value,onChange:p=>z(m,"value",p),autoComplete:"off"})}),e.jsx(W,{variant:"plain",tone:"critical",onClick:()=>Y(m),icon:Se})]},m))]}),e.jsx(we,{}),e.jsxs(F,{gap:"300",children:[e.jsxs(V,{align:"space-between",children:[e.jsxs(k,{as:"h3",variant:"headingSm",children:["What's Included (",a.included.length,")"]}),e.jsx(W,{variant:"plain",onClick:pe,icon:Ie,children:"Add"})]}),a.included.map((l,m)=>e.jsxs(V,{gap:"200",align:"start",blockAlign:"end",children:[e.jsx("div",{style:{flex:2},children:e.jsx($,{label:"Item",value:l.title,onChange:p=>le(m,"title",p),autoComplete:"off"})}),e.jsx("div",{style:{flex:1},children:e.jsx($,{label:"Link (optional)",value:l.link,onChange:p=>le(m,"link",p),autoComplete:"off",placeholder:"/products/..."})}),e.jsx(W,{variant:"plain",tone:"critical",onClick:()=>Z(m),icon:Se})]},m))]}),e.jsx(we,{}),e.jsxs(F,{gap:"400",children:[e.jsxs(k,{as:"h3",variant:"headingSm",children:["Specifications (",a.specs.length," groups)"]}),a.specs.map((l,m)=>e.jsx(Pe,{children:e.jsxs(F,{gap:"300",children:[e.jsx(k,{as:"h4",variant:"headingSm",children:l.heading}),l.lines.map((p,M)=>e.jsxs(V,{gap:"200",align:"start",blockAlign:"end",children:[e.jsx("div",{style:{flex:1},children:e.jsx($,{label:"Spec",value:p.title,onChange:L=>ie(m,M,"title",L),autoComplete:"off",size:"slim"})}),e.jsx("div",{style:{flex:2},children:e.jsx($,{label:"Value",value:p.text,onChange:L=>ie(m,M,"text",L),autoComplete:"off",size:"slim"})}),e.jsx(W,{variant:"plain",tone:"critical",onClick:()=>be(m,M),icon:Se})]},M))]})},m))]}),e.jsx(we,{}),e.jsx(V,{align:"end",children:e.jsx(W,{variant:"primary",onClick:ve,loading:D,disabled:!o,icon:gt,children:"Save to Product Metafields"})}),!o&&e.jsx(oe,{tone:"warning",children:"Please select a product in Step 1 before saving."})]})}),e.jsx(J,{open:h,onClose:()=>T(!1),title:"JSON Preview",children:e.jsx(J.Section,{children:e.jsx("pre",{style:{fontSize:"12px",overflow:"auto",maxHeight:"500px",background:"#f6f6f7",padding:"16px",borderRadius:"8px"},children:JSON.stringify(a,null,2)})})})]})})}function Ut(){const t=ft(),r=()=>t&&typeof t=="object"&&"message"in t&&"suggestion"in t?t:{message:"Something went wrong.",suggestion:"Try refreshing the page or re-opening the app."},{message:o,suggestion:b}=r();return e.jsx(tt,{title:"Product Bridge",children:e.jsx(oe,{tone:"critical",title:o,children:b})})}export{Ut as ErrorBoundary,Zt as default};
